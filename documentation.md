# MD Analysis Visualization Scripts Documentation

This document provides an overview and usage instructions for the Python scripts located in the `vis` directory, designed for visualizing molecular dynamics (MD) simulation data.

## General Usage Notes

*   **Conda Environment:** All scripts are designed to be run within the `kalido` conda environment. Ensure this environment is activated before running any script.
    ```bash
    conda activate kalido
    ```
*   **Data Files:** The analysis scripts (`holo_md_analysis.py` and `apo_md_analysis.py`) expect specific `.dat` files to be present in the specified `--data_dir`. These files should contain numerical data, either in a single column (time will be auto-generated) or two columns (time and value).
*   **Output:** Plots and summary statistics are generated in subdirectories (e.g., `enhanced_analysis/plots/`) within the `--data_dir`.

---

## 1. `md_analysis_base.py`

This script serves as a base module providing core functionalities for MD data processing and visualization. It defines classes like `MDAnalysisConfig`, `MDDataProcessor`, and `EnhancedMDVisualizer`, which are inherited and used by the `holo_md_analysis.py` and `apo_md_analysis.py` scripts.

*   **Purpose:** Provides common configuration management, data cleaning (outlier removal, smoothing), and Plotly visualization utilities.
*   **How to Use:** This script is **not meant to be run directly**. It acts as a library for the other analysis scripts.

---

## 2. `holo_md_analysis.py`

This script is designed to analyze and visualize MD simulation data for **protein-ligand complexes** (holo systems).

*   **Purpose:** Processes various `.dat` files (RMSD, COM-COM, HBonds, ROG, SASA, RMSF) related to protein-ligand interactions, generates interactive plots, and compiles summary statistics.
*   **Input Files:**
    *   `md_analysis_config.json`: Configuration file for visualization and analysis parameters.
    *   `.dat` files (e.g., `RMSD_4.dat`, `comcom_4.dat`, `hbonds_4.dat`, `rog_4.dat`, `SASA_4.dat`, `RMSF_4.dat`, `RMSD_complex_1C14_4.dat`) in the `--data_dir`.
*   **Output:**
    *   Interactive HTML plots (e.g., `rmsd_analysis.html`, `comcom_analysis.html`) in `enhanced_analysis/plots/`.
    *   Static image formats (PNG, SVG) of the plots.
    *   `summary_statistics.csv`: A CSV file containing comprehensive statistics for all processed data, saved in `enhanced_analysis/`.
*   **Command-Line Usage:**
    ```bash
    python holo_md_analysis.py --config md_analysis_config.json --data_dir . --ligands 4 --protein ENOYL_REDUCTASE --res_range 1 300
    ```
    *   `--config <file>`: Path to the configuration JSON file (default: `md_analysis_config.json`).
    *   `--data_dir <path>`: Directory containing the `.dat` files (default: current directory `.`).
    *   `--ligands <name(s)>`: Comma-separated ligand names/IDs (e.g., `4`, `LIG,DRG`).
    *   `--protein <name>`: Name of the protein (e.g., `ENOYL_REDUCTASE`).
    *   `--res_range <start> <end>`: Optional. Start and end residue numbers for analysis (e.g., `1 300`).

---

## 3. `apo_md_analysis.py`

This script is designed to analyze and visualize MD simulation data for **protein-only** (apo systems).

*   **Purpose:** Processes various `.dat` files (RMSD, HBonds, ROG, SASA, RMSF) related to protein dynamics, generates interactive plots, and compiles summary statistics.
*   **Input Files:**
    *   `md_analysis_config.json`: Configuration file for visualization and analysis parameters.
    *   `.dat` files (e.g., `RMSD_apo_4.dat`, `hbonds_apo_4.dat`) in the `--data_dir`.
*   **Output:**
    *   Interactive HTML plots (e.g., `rmsd_apo_analysis.html`) in `enhanced_analysis_apo/plots/`.
    *   Static image formats (PNG, SVG) of the plots.
    *   `summary_statistics_apo.csv`: A CSV file containing comprehensive statistics for all processed data, saved in `enhanced_analysis_apo/`.
*   **Command-Line Usage:**
    ```bash
    python apo_md_analysis.py --config md_analysis_config.json --data_dir . --protein ENOYL_REDUCTASE --res_range 1 300
    ```
    *   `--config <file>`: Path to the configuration JSON file (default: `md_analysis_config.json`).
    *   `--data_dir <path>`: Directory containing the `.dat` files (default: current directory `.`).
    *   `--protein <name>`: Name of the protein (e.g., `ENOYL_REDUCTASE`).
    *   `--res_range <start> <end>`: Optional. Start and end residue numbers for analysis (e.g., `1 300`).

---

## 4. `visualize_statistics.py`

This script is used to visualize the `summary_statistics.csv` (or `summary_statistics_apo.csv`) files generated by the analysis scripts. It creates a single, merged interactive box plot with independent y-axes for each analysis type.

*   **Purpose:** Provides a consolidated, high-level overview of the statistical results from MD simulations, allowing for easy comparison across different analysis types and systems.
*   **Input Files:**
    *   `summary_statistics.csv` (or `summary_statistics_apo.csv`) generated by `holo_md_analysis.py` or `apo_md_analysis.py`.
*   **Output:**
    *   `statistics_summary_merged_no_hover.html`: A single HTML file containing the interactive merged box plot, saved in the specified `--output_dir`.
*   **Command-Line Usage:**
    ```bash
    python visualize_statistics.py --csv_file enhanced_analysis/summary_statistics.csv --output_dir enhanced_analysis/plots
    ```
    *   `--csv_file <path>`: Path to the input CSV file containing summary statistics (default: `enhanced_analysis/summary_statistics.csv`).
    *   `--output_dir <path>`: Directory where the visualization HTML file will be saved (default: `enhanced_analysis/plots`).
